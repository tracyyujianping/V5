<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Copilot Industry 4.0 Network Estimator</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Set Calibri as the primary font with fallbacks */
        body { font-family: Calibri, Candara, Segoe, "Segoe UI", Optima, Arial, sans-serif; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Style for the Services Toggle switch */
        .toggle-checkbox:checked { right: 0; border-color: #3b82f6; } 
        .toggle-checkbox:checked + .toggle-label { background-color: #3b82f6; }

        /* --- PDF Watermark and Print Styling (Updated for Full Page Export) --- */
        @media print {
            body { 
                background-color: #ffffff; /* Ensure white background for PDF */
                color: #000000;
            }
            
            /* Hide non-essential UI elements for print */
            header, footer, .print-hide, .export-button, .notification-banner, .modal-overlay {
                display: none !important;
            }
            
            /* Make the main grid flow vertically and take full width */
            .grid-container {
                display: block !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            /* Input and Result panels should be visible and take full width */
            #input-panel, #result-panel {
                box-shadow: none !important;
                border: 1px solid #ccc !important; /* Add subtle border to separate sections */
                padding: 15px !important; /* Adjust padding for print */
                width: 100% !important;
                max-width: none !important;
                margin-bottom: 20px; /* Space between the two panels */
                background-color: #ffffff !important;
                color: #000000 !important;
            }
            
            /* Remove column restrictions for full width flow */
            .md\:col-span-5, .md\:col-span-7 { width: 100% !important; }
            
            /* Reset table colors for better print contrast */
            #result-panel table { color: #000; }
            #result-panel thead { background-color: #e5e7eb !important; color: #374151 !important; }
            #result-panel tbody tr { background-color: #fff !important; }
            #result-panel .bg-slate-700\/80 { background-color: #f3f4f6 !important; border: 1px solid #e5e7eb !important; }
            #result-panel .text-green-400 { color: #059669 !important; }
            
            /* Watermark remains */
            .watermark-container::before {
                content: "For recommended vendor and detailed technical proposal please contact MyProNet2025@gmail.com";
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) rotate(-45deg);
                font-size: 24px;
                font-weight: bold;
                color: rgba(0, 0, 0, 0.1); 
                pointer-events: none;
                z-index: 9999;
                white-space: nowrap;
                letter-spacing: 2px;
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- 1. Database Configuration ---
        const DB = {
            // Technology multiplier (17.5% cheaper for 4G)
            techMultipliers: {
                '5G': 1.0,
                '4G': 0.825 
            },
            // Vendor options updated to be neutral and multiplier updated to 1.75
            vendors: {
                cost_efficient: { name: "Cost Efficient", multiplier: 1.0, desc: "Optimized for price performance and scalability." },
                tier1: { name: "Tier 1 Supplier", multiplier: 1.75, desc: "Represents solutions from established, large-scale vendors (1.5x-2x price range)." }
            },
            // Base Prices (USD)
            basePrices: {
                coreNetwork: { name: "Core Network (Lightweight)" }, 
                // Indoor Unit (Small Cell): 25dBm
                smallCell: { min: 3900, max: 4100, name: "Small Cell (Indoor RAN, 25dBm)" },
                // Outdoor Unit (All-in-One): 20W (43 dBm)
                outdoorUnit: { min: 40000, max: 42000, name: "All-in-One Outdoor RAN (20W)" },
                cabling: { min: 3.5, max: 4.5, name: "Cabling & Accessories (per meter)" },
                serviceRate: 0.15 // 15% Installation/Service Fee
            },
            // Coverage Radius Estimates (meters) - Empirical algorithm based on frequency and scenario type (partition/penetration loss)
            coverage: {
                // Office: High partition/wall loss (smallest radius)
                office: { "700M": 125, "2.6G": 33, "3.5G": 25, "4.9G": 18 }, 
                // Factory: Lower partition loss (open space, larger radius ~ +20%)
                factory: { "700M": 150, "2.6G": 40, "3.5G": 30, "4.9G": 22 }, 
                // Mine: Outdoor/Linear (Low path loss)
                mine: { "700M": 1100, "2.6G": 295, "3.5G": 220, "4.9G": 156 }
            }
        };

        // --- 2. Main Component ---
        function App() {
            const [input, setInput] = useState({
                area: 5000,          
                scenario: 'factory', 
                freq: '3.5G',        
                users: 50,
                vendor: 'cost_efficient', // Updated default vendor
                deployment: 'indoor', 
                includeServices: true,
                location: 'Los Angeles, CA', 
                technology: '5G'
            });

            const [result, setResult] = useState(null);
            const [notification, setNotification] = useState(null); 
            const [showLeadModal, setShowLeadModal] = useState(false); // State for the Lead Gen Modal
            
            // Lead Form State
            const [leadForm, setLeadForm] = useState({
                name: '',
                email: '',
                company: '',
                phone: ''
            });

            const calculate = () => {
                const { area, scenario, freq, users, vendor, deployment, includeServices, technology } = input;
                
                const coverageKey = scenario; 
                const radius = DB.coverage[coverageKey][freq];
                
                const vendorMultiplier = DB.vendors[vendor].multiplier;
                const techMultiplier = DB.techMultipliers[technology]; 

                let unitCount = 0;
                let items = [];

                // --- 1. Conditional Price Logic ---
                // CORE Network Price Logic: users < 500 => $28,000, users >= 500 => $46,000
                const corePriceMin = users < 500 ? 28000 : 46000;
                const corePriceMax = corePriceMin * 1.05;

                // --- 2. Calculate Unit Count ---
                if (scenario === 'mine') {
                    // Linear coverage calculation (length / diameter)
                    unitCount = Math.ceil(area / (radius * 2));
                } else {
                    // Area coverage calculation (Area / single cell area, 0.6 is for overlap/inefficiency)
                    const singleCoverage = Math.PI * radius * radius * 0.6; 
                    unitCount = Math.ceil(area / singleCoverage);
                }
                unitCount = Math.max(1, unitCount);

                // --- 3. Build BOM based on deployment type ---
                if (deployment === 'indoor') {
                    const smallCellCount = unitCount;
                    const cableLength = smallCellCount * 80; // Estimated cable length per indoor unit

                    items = [
                        { name: DB.basePrices.coreNetwork.name, min: corePriceMin, max: corePriceMax, count: 1, unit: "Set" },
                        { ...DB.basePrices.smallCell, count: smallCellCount, unit: "Unit" },
                        { ...DB.basePrices.cabling, count: cableLength, unit: "m" }
                    ];

                } else { // outdoor
                    const outdoorUnitCount = unitCount;
                    const cableLength = outdoorUnitCount * 50; // Estimated cable length per outdoor unit

                    items = [
                        { name: DB.basePrices.coreNetwork.name, min: corePriceMin, max: corePriceMax, count: 1, unit: "Set" },
                        { ...DB.basePrices.outdoorUnit, count: outdoorUnitCount, unit: "Unit" },
                        { ...DB.basePrices.cabling, count: cableLength, unit: "m" }
                    ];
                }

                // --- 4. Apply Vendor & Technology Multipliers and Calculate Totals ---
                items = items.map(item => ({
                    ...item,
                    // Apply both technology (4G discount) and vendor multipliers
                    min: Math.round(item.min * vendorMultiplier * techMultiplier),
                    max: Math.round(item.max * vendorMultiplier * techMultiplier)
                }));
                
                let totalMin = 0;
                let totalMax = 0;

                items.forEach(item => {
                    item.subtotalMin = item.min * item.count;
                    item.subtotalMax = item.max * item.count;
                    totalMin += item.subtotalMin;
                    totalMax += item.subtotalMax;
                });

                // --- 5. Services Toggle Logic ---
                let serviceFeeMin = 0;
                let serviceFeeMax = 0;
                
                if (includeServices) {
                    serviceFeeMin = totalMin * DB.basePrices.serviceRate;
                    serviceFeeMax = totalMax * DB.basePrices.serviceRate;
                }

                setResult({
                    items,
                    hardwareMin: totalMin,
                    hardwareMax: totalMax,
                    serviceMin: serviceFeeMin,
                    serviceMax: serviceFeeMax,
                    grandTotalMin: totalMin + serviceFeeMin,
                    grandTotalMax: totalMax + serviceFeeMax,
                    unitName: deployment === 'indoor' ? 'Small Cells' : 'All-In-One RAN Units'
                });
            };

            useEffect(() => {
                calculate();
            }, [input]);

            const fmtMoney = (num) => "$" + Math.round(num).toLocaleString();

            // 1. User clicks Export -> Opens Modal
            const initiateExport = () => {
                setShowLeadModal(true);
            };

            // 2. User Submits Form -> Saves Data (Simulation) -> Prints PDF
            const handleFormSubmit = (e) => {
                e.preventDefault();
                
                // Here you would send 'leadForm' and 'input' data to your backend (e.g., Firebase/Supabase)
                console.log("Lead Generated:", leadForm);
                console.log("Project Details:", input);

                // Close modal
                setShowLeadModal(false);

                // Trigger Print
                window.print();

                // Show Success Notification
                setNotification({
                    message: `Thank you, ${leadForm.name}. The PDF print dialog has been launched.`,
                    type: 'info'
                });
                setTimeout(() => setNotification(null), 8000);
            };

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-5xl mx-auto watermark-container">
                    
                    {/* Notification Banner */}
                    {notification && (
                        <div className={`notification-banner fixed top-4 left-1/2 -translate-x-1/2 max-w-lg w-full p-4 rounded-lg shadow-2xl z-50 transition-all duration-300 ${notification.type === 'info' ? 'bg-amber-500 text-white' : 'bg-red-500 text-white'}`}>
                            <div className="font-bold text-center">
                                {notification.message}
                            </div>
                        </div>
                    )}

                    {/* Lead Capture Modal */}
                    {showLeadModal && (
                        <div className="modal-overlay fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 animate-fade-in">
                            <div className="bg-white rounded-xl shadow-2xl max-w-md w-full p-6 relative overflow-hidden">
                                <button 
                                    onClick={() => setShowLeadModal(false)}
                                    className="absolute top-4 right-4 text-gray-400 hover:text-gray-600"
                                >
                                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                                </button>
                                
                                <div className="text-center mb-6">
                                    <h3 className="text-2xl font-bold text-slate-800">Unlock Detailed Proposal</h3>
                                    <p className="text-gray-500 text-sm mt-1">Please complete this form to download your detailed Bill of Materials (BOM).</p>
                                </div>

                                <form onSubmit={handleFormSubmit} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-1">Full Name</label>
                                        <input 
                                            required
                                            type="text" 
                                            className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                            value={leadForm.name}
                                            onChange={(e) => setLeadForm({...leadForm, name: e.target.value})}
                                            placeholder="John Doe"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-1">Business Email</label>
                                        <input 
                                            required
                                            type="email" 
                                            className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                            value={leadForm.email}
                                            onChange={(e) => setLeadForm({...leadForm, email: e.target.value})}
                                            placeholder="john@company.com"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-1">Company Name</label>
                                        <input 
                                            required
                                            type="text" 
                                            className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                            value={leadForm.company}
                                            onChange={(e) => setLeadForm({...leadForm, company: e.target.value})}
                                            placeholder="Company Ltd."
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-semibold text-gray-700 mb-1">Phone Number (Optional)</label>
                                        <input 
                                            type="tel" 
                                            className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                            value={leadForm.phone}
                                            onChange={(e) => setLeadForm({...leadForm, phone: e.target.value})}
                                            placeholder="+1 (555) 000-0000"
                                        />
                                    </div>
                                    
                                    <button 
                                        type="submit"
                                        className="w-full bg-blue-600 hover:bg-blue-500 text-white py-3 rounded-lg font-bold transition-colors shadow-lg mt-2"
                                    >
                                        Download PDF Quote
                                    </button>
                                    <p className="text-xs text-gray-400 text-center mt-2">
                                        Your data is secure. We will not spam you.
                                    </p>
                                </form>
                            </div>
                        </div>
                    )}

                    {/* Header with Logo and Title */}
                    <header className="mb-10 flex flex-col items-center justify-center text-center print-hide">
                        <div className="flex flex-col items-center gap-2 mb-2">
                            {/* CSS/SVG Lego Block Icon with ProNet text */}
                            <div className="mb-2"> 
                                <svg width="60" height="60" viewBox="0 0 100 100" className="drop-shadow-lg transform -rotate-6 hover:rotate-0 transition-transform duration-300">
                                    <defs>
                                        <filter id="inset-shadow">
                                            <feOffset dx="0" dy="2"/><feGaussianBlur stdDeviation="2" result="offset-blur"/>
                                            <feComposite operator="out" in="SourceGraphic" in2="offset-blur" result="inverse"/>
                                            <feFlood floodColor="black" floodOpacity="0.2" result="color"/>
                                            <feComposite operator="in" in="color" in2="inverse" result="shadow"/>
                                            <feComposite operator="over" in="shadow" in2="SourceGraphic"/> 
                                        </filter>
                                    </defs>
                                    <rect x="5" y="25" width="90" height="60" rx="4" fill="#E3000B" stroke="#b30000" strokeWidth="2" filter="url(#inset-shadow)" />
                                    <circle cx="25" cy="25" r="12" fill="#E3000B" stroke="#b30000" strokeWidth="1" />
                                    <circle cx="75" cy="25" r="12" fill="#E3000B" stroke="#b30000" strokeWidth="1" />
                                    <text x="50" y="65" textAnchor="middle" fontSize="16" fill="white" fontWeight="bold">ProNet</text>
                                </svg>
                            </div>
                            
                            {/* Title (Updated second line) */}
                            <h1 className="text-3xl font-extrabold text-slate-800 tracking-tight leading-none">
                                Copilot Industry 4.0
                            </h1>
                            <p className="text-xl font-medium text-gray-500 mt-1">
                                Private Mobile Network Instant BOM Estimator
                            </p>
                        </div>
                    </header>

                    <div className="grid md:grid-cols-12 gap-6 grid-container">
                        
                        {/* LEFT: Input Panel */}
                        <div id="input-panel" className="md:col-span-5 bg-white p-6 rounded-xl shadow-lg border border-blue-100 h-fit">
                            <h2 className="text-xl font-semibold mb-6 flex items-center text-slate-800">
                                <span className="bg-blue-600 text-white w-7 h-7 rounded-full flex items-center justify-center text-sm mr-2 shadow-sm">1</span>
                                Project Parameters
                            </h2>
                            
                            <div className="space-y-5">
                                
                                {/* Location of the Project */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Location of the Project</label>
                                    <input 
                                        type="text" 
                                        className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-shadow bg-gray-50"
                                        value={input.location}
                                        onChange={(e) => setInput({...input, location: e.target.value})}
                                        placeholder="City, Country"
                                    />
                                </div>

                                {/* Preferred Technology (4G/5G only) */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Preferred Technology</label>
                                    <div className="grid grid-cols-2 gap-2">
                                        {['4G', '5G'].map(tech => (
                                            <button 
                                                key={tech} 
                                                onClick={() => setInput({...input, technology: tech})}
                                                className={`py-2 px-1 rounded-lg border text-sm transition-all ${
                                                    input.technology === tech 
                                                    ? 'bg-blue-600 text-white border-blue-600 shadow-md' 
                                                    : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'
                                                }`}
                                            >
                                                <div className="font-bold">{tech}</div>
                                            </button>
                                        ))}
                                    </div>
                                    <p className="text-xs text-gray-400 mt-1 text-center">4G selected: Estimated 17.5% cost reduction applied to hardware.</p>
                                </div>


                                {/* Deployment Type (Indoor/Outdoor only, text simplified) */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Deployment Type</label>
                                    <div className="flex gap-4">
                                        <button 
                                            onClick={() => setInput({...input, deployment: 'indoor'})}
                                            className={`flex-1 py-2 px-4 rounded-lg border text-sm transition-all ${
                                                input.deployment === 'indoor' 
                                                ? 'bg-indigo-600 text-white border-indigo-600 shadow-md' 
                                                : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'
                                            }`}
                                        >
                                            <span className='font-bold'>Indoor</span>
                                        </button>
                                        <button 
                                            onClick={() => setInput({...input, deployment: 'outdoor'})}
                                            className={`flex-1 py-2 px-4 rounded-lg border text-sm transition-all ${
                                                input.deployment === 'outdoor' 
                                                ? 'bg-indigo-600 text-white border-indigo-600 shadow-md' 
                                                : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'
                                            }`}
                                        >
                                            <span className='font-bold'>Outdoor</span>
                                        </button>
                                    </div>
                                    <p className="text-xs text-gray-400 mt-1">Indoor: 25dBm Small Cell. Outdoor: 20W All-in-One RAN.</p>
                                </div>


                                {/* Vendor Selection (Updated) */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Equipment Vendor</label>
                                    <select 
                                        className="w-full p-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                        value={input.vendor}
                                        onChange={(e) => setInput({...input, vendor: e.target.value})}
                                    >
                                        {Object.entries(DB.vendors).map(([key, val]) => (
                                            <option key={key} value={key}>{val.name}</option>
                                        ))}
                                    </select>
                                    <p className="text-xs text-blue-600 mt-1">{DB.vendors[input.vendor].desc}</p>
                                </div>

                                {/* Scenario - Restored as an independent factor affecting coverage */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Scenario</label>
                                    <select 
                                        className="w-full p-2.5 bg-gray-50 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                        value={input.scenario}
                                        onChange={(e) => setInput({...input, scenario: e.target.value})}
                                    >
                                        <option value="office">Office (High Partitions/Walls Loss)</option>
                                        <option value="factory">Smart Factory (Open Space/Low Loss)</option>
                                        <option value="mine">Mine / Tunnel (Linear Coverage)</option>
                                    </select>
                                    <p className="text-xs text-gray-400 mt-1">Coverage radius is adjusted based on expected partition/penetration losses.</p>
                                </div>

                                {/* Area */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">
                                        {input.scenario === 'mine' ? 'Total Length (meters)' : 'Total Area (sqm)'}
                                    </label>
                                    <input 
                                        type="number" 
                                        className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-shadow"
                                        value={input.area}
                                        onChange={(e) => setInput({...input, area: parseInt(e.target.value) || 0})}
                                    />
                                </div>

                                {/* Frequency (Updated with 700M) */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Frequency Band</label>
                                    <div className="grid grid-cols-4 gap-2">
                                        {['700M', '2.6G', '3.5G', '4.9G'].map(f => (
                                            <button 
                                                key={f} 
                                                onClick={() => setInput({...input, freq: f})}
                                                className={`py-2 px-1 rounded-lg border text-sm transition-all ${
                                                    input.freq === f 
                                                    ? 'bg-blue-600 text-white border-blue-600 shadow-md' 
                                                    : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'
                                                }`}
                                            >
                                                <div className="font-bold">{f}</div>
                                            </button>
                                        ))}
                                    </div>
                                    <div className="text-xs text-gray-400 mt-1 text-center">
                                        Higher frequency means higher capacity but smaller coverage radius.
                                    </div>
                                </div>

                                {/* Users */}
                                <div>
                                    <label className="block text-sm font-bold text-gray-700 mb-2">Est. Devices / Cameras</label>
                                    <input 
                                        type="number" 
                                        className="w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                        value={input.users}
                                        onChange={(e) => setInput({...input, users: parseInt(e.target.value) || 0})}
                                    />
                                    <p className="text-xs text-gray-400 mt-1">Device count determines Core Network pricing ($28k or $46k).</p>
                                </div>
                                
                                {/* Services Toggle */}
                                <div className="flex items-center justify-between py-3 border-t border-gray-200 pt-5">
                                    <label htmlFor="service-toggle" className="text-sm font-bold text-gray-700 select-none">
                                        Include Services (Design, Install)
                                    </label>
                                    <div className="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                                        <input 
                                            type="checkbox" 
                                            name="service-toggle" 
                                            id="service-toggle" 
                                            checked={input.includeServices}
                                            onChange={(e) => setInput({...input, includeServices: e.target.checked})}
                                            className="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-200"
                                        />
                                        <label htmlFor="service-toggle" className="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* RIGHT: Result Panel */}
                        <div id="result-panel" className="md:col-span-7 bg-slate-800 text-white p-6 rounded-xl shadow-lg relative overflow-hidden fade-in flex flex-col">
                            {/* Background Decoration */}
                            <div className="absolute top-0 right-0 p-6 opacity-5 pointer-events-none print-hide">
                                <svg width="150" height="150" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                            </div>

                            <h2 className="text-xl font-semibold mb-6 flex items-center z-10">
                                <span className="bg-green-500 text-white w-7 h-7 rounded-full flex items-center justify-center text-sm mr-2 shadow-sm">2</span>
                                Bill of Materials (BOM) & Total
                            </h2>

                            {result && (
                                <div className="space-y-5 z-10 flex-1 flex flex-col">
                                    {/* Project Summary Card */}
                                    <div className="bg-slate-700/80 backdrop-blur-sm p-5 rounded-lg border border-slate-600 shadow-inner">
                                        <div className="text-slate-400 text-sm mb-1">Project Summary (Location: {input.location})</div>
                                        <div className="text-4xl font-bold text-green-400 tracking-tight">
                                            {fmtMoney(result.grandTotalMin)} - {fmtMoney(result.grandTotalMax)}
                                        </div>
                                        <div className="flex justify-between items-end mt-2 text-sm">
                                            <div className="text-xs text-slate-400">*Includes Hardware {input.includeServices ? ' & Services' : ''}</div>
                                            <div className="flex gap-2">
                                                <div className="bg-blue-600 px-2 py-1 rounded text-white font-bold">{input.technology}</div>
                                                <div className="bg-slate-600 px-2 py-1 rounded text-white">{DB.vendors[input.vendor].name}</div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Table */}
                                    <div className="overflow-x-auto rounded-lg border border-slate-600">
                                        <table className="w-full text-sm text-left">
                                            <thead className="text-xs text-slate-300 uppercase bg-slate-900/50">
                                                <tr>
                                                    <th className="px-3 py-3">Item</th>
                                                    <th className="px-3 py-3 text-center">Qty</th>
                                                    <th className="px-3 py-3 text-right">Est. Cost</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-700 bg-slate-800">
                                                {result.items.map((item, idx) => (
                                                    <tr key={idx} className="hover:bg-slate-700/50 transition-colors">
                                                        <td className="px-3 py-3 font-medium text-slate-200">{item.name}</td>
                                                        <td className="px-3 py-3 text-center text-blue-300 font-bold whitespace-nowrap">
                                                            {item.count} <span className="text-xs font-normal text-slate-500">{item.unit}</span>
                                                        </td>
                                                        <td className="px-3 py-3 text-right text-slate-300 font-mono">
                                                            {fmtMoney(item.subtotalMin)}
                                                        </td>
                                                    </tr>
                                                ))}
                                                <tr className={`transition-opacity ${input.includeServices ? 'bg-slate-700/20 opacity-100' : 'opacity-50'}`}>
                                                    <td className="px-3 py-3 text-slate-400 italic">Services (Design, Install)</td>
                                                    <td className="px-3 py-3 text-center text-slate-500">-</td>
                                                    <td className="px-3 py-3 text-right text-slate-400 font-mono">
                                                        {input.includeServices ? fmtMoney(result.serviceMin) : "$0 (Excluded)"}
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    {/* Metrics Grid */}
                                    <div className="grid grid-cols-2 gap-3 mt-2">
                                        <div className="bg-slate-700/40 p-3 rounded-lg text-center border border-slate-600/50">
                                            <div className="text-xs text-slate-400 uppercase tracking-wider">Cell Radius (Calculated)</div>
                                            <div className="font-bold text-lg">{DB.coverage[input.scenario][input.freq]}m</div>
                                        </div>
                                        <div className="bg-slate-700/40 p-3 rounded-lg text-center border border-slate-600/50">
                                            <div className="text-xs text-slate-400 uppercase tracking-wider">Total {result.unitName}</div>
                                            <div className="font-bold text-lg text-blue-400">
                                                {/* Safely access 'count' property */}
                                                {result.items.find(i => i.name.includes(input.deployment === 'indoor' ? 'Small Cell' : 'All-in-One'))?.count || 0}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Footer Button and Contact Box */}
                                    <div className="mt-auto pt-4 flex flex-col gap-3">
                                        <button 
                                            className="export-button w-full bg-blue-600 hover:bg-blue-500 active:bg-blue-700 text-white py-3 rounded-lg font-bold transition-all shadow-lg hover:shadow-blue-500/30 flex justify-center items-center gap-2"
                                            onClick={initiateExport}
                                        >
                                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                            Export PDF Quote
                                        </button>

                                        {/* Deep Dark Box for Contact Info (#3) - UPDATED EMAIL LINK */}
                                        <div className="bg-slate-900 border-l-4 border-amber-500 p-4 rounded-lg shadow-xl text-center">
                                            <div className="text-xs font-bold uppercase text-amber-400 mb-1">More Detailed Proposal</div>
                                            <p className="text-sm font-medium text-slate-200">
                                                For recommended vendors and a detailed technical proposal, please contact:
                                            </p>
                                            {/* Mailto Link Implementation with Calibri Font */}
                                            <p className="text-lg font-bold text-amber-500 mt-2 break-all" style={{fontFamily: 'Calibri, Candara, Segoe, "Segoe UI", Optima, Arial, sans-serif'}}>
                                                <a 
                                                    href="mailto:MyProNet2025@gmail.com" 
                                                    className="text-amber-500 hover:text-amber-300 transition-colors underline"
                                                >
                                                    MyProNet2025@gmail.com
                                                </a>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>

                    <footer className="mt-12 text-center text-gray-400 text-sm pb-8 print-hide">
                        <p>Â© 2025 ProNet Team | Beta v1.6</p>
                        <p className="text-xs mt-2 max-w-2xl mx-auto">Disclaimer: This tool provides rough estimates only based on typical industry values. Actual costs depend on site survey, wall materials, and specific vendor negotiations. Transmission line rental and electricity costs are not included.</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>